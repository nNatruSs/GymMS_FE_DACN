<!-- 
<div class="container-fluid py-4 bg-light min-vh-100">


  <div *ngIf="loading" class="d-flex justify-content-center align-items-center" style="height: 300px;">
    <div class="spinner-border text-primary" role="status"></div>
  </div>

  <div *ngIf="!loading" class="container-lg">

 
    <div class="card shadow-sm border-0 mb-5 membership-card">
      <div class="card-body">
        <h5 class="card-title fw-semibold mb-4">My Membership Status</h5>

        <ng-container *ngIf="membership; else noMembership">
          <div class="row text-center text-md-start">
            <div class="col-md-3 mb-3">
              <small class="text-muted">Plan</small>
              <div class="fs-5 fw-semibold text-primary text-capitalize">
                {{ membership.plan }}
              </div>
            </div>
            <div class="col-md-3 mb-3">
              <small class="text-muted">Duration</small>
              <div class="fw-medium">{{ membership.duration_days }} days</div>
            </div>
            <div class="col-md-3 mb-3">
              <small class="text-muted">Start Date</small>
              <div class="fw-medium">{{ membership.start_date }}</div>
            </div>
            
            <div class="col-md-3 mb-3">
              <small class="text-muted">End Date</small>
              <div class="fw-medium">{{ getEndDate() }}</div>
            </div>
          </div>

          <div class="mt-2 pb-1 px-5">
            <small class="text-muted">Membership Progress</small>
            <div class="progress mt-1" style="height: 12px;">
              <div
                class="progress-bar bg-primary"
                [style.width.%]="getProgressPercent()"
              ></div>
            </div>

            <small class="text-muted">
              {{ getRemainingDays() }} days remaining
            </small>
          </div>

          <div class="mt-4 d-flex gap-2 flex-wrap">
            <button
              class="btn btn-primary px-4"
              (click)="extend()"
            >
              Extend Membership
            </button>

            <button
              class="btn btn-outline-danger px-4"
              (click)="cancel()"
            >
              Cancel Membership
            </button>
          </div>
        </ng-container>

        <ng-template #noMembership>
          <p class="text-muted fst-italic mb-0">
            You don’t currently have an active membership.
          </p>
        </ng-template>
      </div>
    </div>

  


    <h5 class="fw-semibold mb-4">Available Membership Plans</h5>

    <div class="row g-4">
      <div
        class="col-md-6 col-lg-4"
        *ngFor="let plan of plans"
      >
        <div class="card h-100 border-0 shadow-sm plan-card">
          <div class="card-body text-center">
            <img
              [src]="plan.image_url"
              alt="{{ plan.name }}"
              class="img-fluid mb-3 plan-img"
              style="height: 80px;"
            />

            <h6 class="fw-semibold text-capitalize">{{ plan.name }}</h6>

            <p class="text-muted small">
              {{ plan.benefits }}
            </p>

            <div class="fs-4 fw-bold text-primary mb-3">
              ${{ plan.price }}
              <small class="fs-6 text-muted">/ {{ plan.duration_days }} days</small>
            </div>

            <button
              *ngIf="!membership"
              class="btn btn-primary w-100"
              (click)="register(plan)"
            >
              Register Membership
            </button>
          </div>
        </div>
      </div>
    </div>

  </div>
</div> -->


<div class="container-fluid py-4 bg-light min-vh-100">

  <!-- LOADING -->
  <div *ngIf="loading" class="d-flex justify-content-center align-items-center" style="height: 300px;">
    <div class="spinner-border text-primary"></div>
  </div>

  <div *ngIf="!loading" class="container-lg">

    <!-- ================= CURRENT MEMBERSHIP ================= -->
    <div class="card shadow-sm border-0 mb-5 membership-card">
      <div class="card-body">
        <h5 class="fw-semibold mb-4">My Membership Status</h5>

        <ng-container *ngIf="membership; else noMembership">

          <div class="row g-4 align-items-center">
            <div class="col-md-3">
              <small class="text-muted">Plan</small>
              <div class="fs-4 fw-bold text-primary text-capitalize">
                {{ membership.plan }}
              </div>
            </div>

            <div class="col-md-3">
              <small class="text-muted">Duration</small>
              <div class="fw-medium">{{ membership.duration_days }} days</div>
            </div>

            <div class="col-md-3">
              <small class="text-muted">Start Date</small>
              <div class="fw-medium">{{ membership.start_date }}</div>
            </div>

            <div class="col-md-3">
              <small class="text-muted">End Date</small>
              <div class="fw-medium">{{ getEndDate() }}</div>
            </div>
          </div>

          <!-- PROGRESS -->
          <div class="mt-4">
            <div class="d-flex justify-content-between mb-1">
              <small class="text-muted">Membership Progress</small>
              <small class="text-muted">
                {{ getRemainingDays() }} days remaining
              </small>
            </div>

            <div class="progress" style="height: 10px;">
              <div
                class="progress-bar bg-primary"
                [style.width.%]="getProgressPercent()"
              ></div>
            </div>
          </div>

          <!-- ACTIONS -->
          <div class="mt-4 d-flex gap-2 flex-wrap">
            <button
              class="btn btn-primary px-4"
              (click)="openExtendModal()"
            >
              Extend Membership
            </button>

            <button
              class="btn btn-outline-danger px-4"
              (click)="openCancelModal()"
            >
              Cancel Membership
            </button>
          </div>

        </ng-container>

        <ng-template #noMembership>
          <div class="alert alert-warning mb-0">
            You don’t currently have an active membership.
          </div>
        </ng-template>
      </div>
    </div>

    <!-- ================= PLANS ================= -->
    <h5 class="fw-semibold mb-4">Available Membership Plans</h5>

    <div class="row g-4">
      <div class="col-md-6 col-lg-4" *ngFor="let plan of plans">
        <div class="card plan-card h-100 border-0 shadow-sm text-center">
          <div class="card-body">

            <img
              [src]="plan.image_url"
              class="plan-img mb-3"
              alt="{{ plan.name }}"
            />

            <h6 class="fw-bold text-capitalize">{{ plan.name }}</h6>

            <p class="text-muted small mb-3">
              {{ plan.benefits }}
            </p>

            <div class="fs-4 fw-bold text-primary mb-3">
              ${{ plan.price }}
              <small class="fs-6 text-muted">/ {{ plan.duration_days }} days</small>
            </div>

            <button
              *ngIf="!membership"
              class="btn btn-primary w-100"
              (click)="register(plan)"
            >
              Register Membership
            </button>

            <span
              *ngIf="membership?.plan === plan.name"
              class="badge bg-success"
            >
              Current Plan
            </span>

          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- ================= MODALS ================= -->
<app-extend-membership-modal
  *ngIf="showExtendModal"
  [membership]="membership"
  (close)="showExtendModal=false"
  (confirm)="extendConfirmed($event)">
</app-extend-membership-modal>

<app-confirm-modal
  *ngIf="showCancelModal"
  title="Cancel Membership"
  message="Are you sure you want to cancel your membership? This action cannot be undone."
  confirmText="Yes, Cancel"
  confirmType="danger"
  (confirm)="cancelConfirmed()"
  (close)="showCancelModal=false">
</app-confirm-modal>
